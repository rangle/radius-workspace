import { useState, useRef } from 'react';
import { Meta, Subtitle, Preview, Story } from '@storybook/addon-docs/blocks';
import { ThemeProvider } from 'styled-components';
import {
  Box,
  Flex,
  Text,
  Heading,
  Icons,
  Button,
  TextArea,
  Label,
  Input,
  FormControl,
  Checkbox,
  AspectImage,
  Image,
  Link,
  Select,
} from './components';
import theme from './theme';
import logo from './imgs/rangle_badge_black.svg';
import img from './imgs/design-systems_16_9.png';

<Meta title="Kitchen Sink Demo" />

export const NavBar = () => {
  return (
    <Flex
      as="nav"
      bg="bg.primary"
      alignItems="flex-end"
      mb={3}
      py={[2, 2, 0]}
      borderBottomWidth={['3px', '3px', 0]}
      borderBottomStyle="solid"
      borderBottomColor="brand.primary">
      <Image
        flex="none"
        height={2}
        mr={3}
        borderRadius="100%"
        alt="Home"
        src={logo}
      />
      <Box flex="1 1 auto" display={['none', 'none', 'block']}>
        <Flex
          borderBottomWidth="1px"
          borderBottomStyle="solid"
          borderBottomColor="ui.quaternary"
        >
          <Link variant="nav1" href="/" ml="auto">
            Link
          </Link>
          <Link variant="nav1" ml={3} href="/">Link</Link>
          <Link variant="nav1" ml={3} href="/">Link</Link>
          <Link variant="nav1" ml={3} href="/">Link</Link>
          <Link variant="nav1" ml={3} href="/">Link</Link>
        </Flex>
      </Box>
      <Button
        ml="auto"
        mt={-2}
        mb={-11}
        variant="transparent"
        display={['flex', 'flex', 'none']}
        borderLeftColor="ui.tertiary"
        borderLeftWidth="1px"
        borderBottomWidth="3px"
        borderBottomColor="ui.primary">
        <Icons.Search title="clear" fontSize={4} color="ui.primary" />
      </Button>
      <Button
        mt={-2}
        mb={-11}
        ml="-1px"
        variant="transparent"
        display={['flex', 'flex', 'none']}
        borderLeftColor="ui.tertiary"
        borderLeftWidth="1px"
        borderRightColor="ui.tertiary"
        borderRightWidth="1px"
        borderBottomWidth="3px"
        borderBottomColor="ui.primary">
        <img src="https://icon.now.sh/menu/20/404040" />
      </Button>
    </Flex>
  );
};

export const FormExample = () => {
  const [query, setQuery] = useState('Houston');
  const searchInput = useRef(null);
  function handleClear() {
    setQuery('');
    searchInput.current.focus();
  }
  return (
    <FormControl.Field mb={4}>
      <Label htmlFor="search">Find a Location</Label>
      <Input
        id="search"
        ref={searchInput}
        aria-describedby="helper-text"
        placeholder="Search"
        value={query}
        onChange={e => setQuery(e.target.value)}
        leftIcon={<Icons.Search aria-hidden />}
        rightIcon={
          query && (
            <Button variant="transparent" p={0} onClick={handleClear}>
              <Icons.Close title="clear" color="brand.primary" />
            </Button>
          )
        }
      />
      <FormControl.Hint id="helper-text">
        Search by city, address, or postal code
      </FormControl.Hint>
    </FormControl.Field>
  );
};

<ThemeProvider theme={theme.light}>
  <Box my={5}>
    <NavBar />
    <Flex flexDirection={['column', 'column', 'row']} alignItems="flex-start" my={5}>
      <Box pr={4} flex="none" width={['100%', '100%', '50%']} order={[1, 1, 0]}>
        <Heading variant="heading-4" mb={3}>
          Tortor at auctor urna nunc id cursus metus
        </Heading>
        <Text variant="body" mb={3}>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Mi tempus imperdiet nulla malesuada pellentesque elit eget gravida. Aliquam nulla facilisi cras fermentum. Orci ac auctor augue mauris.
        </Text>
        <Text variant="body" mb={3}>
         Pellentesque id nibh tortor id aliquet lectus. Morbi tristique senectus et netus. Sit amet aliquam id diam maecenas ultricies mi eget mauris. Ut placerat orci nulla pellentesque dignissim. Dolor magna eget est lorem ipsum dolor. Commodo sed egestas egestas fringilla phasellus faucibus scelerisque eleifend donec.
        </Text>
        <Button rightIcon={<Icons.Info aria-hidden />} variant="secondary" py={3} px={[3, 3, 4]} mb={2}>
          Learn more here
        </Button>
        <Text variant="caption" fontStyle="italic"><sup>1</sup>Est ante in nibh mauris cursus</Text>
      </Box>
      <Box flex="1 1 auto" mb={[3, 3, 0]}>
        <Image alt="" src={img} width="100%" />
      </Box>
    </Flex>
    <Flex flexDirection={['column', 'column', 'row']} my={5}>
      <Box mr={[0, 0, 4]} flex="none" width={['100%', '100%', '50%']}>
        <Box bg="bg.secondary" p={4} mb={4}>
          <Flex alignItems="center" flexWrap="wrap">
            <Button variant="primary" mr={3} mb={3}>
              Primary
            </Button>
            <Button
              variant="primary"
              leftIcon={<Icons.CheckboxChecked aria-hidden />}
              mr={3}
              mb={3}
            >
              Left Icon
            </Button>
            <Button variant="primary" mb={3} isLoading>
              Loading
            </Button>
          </Flex>
          <Flex alignItems="center" flexWrap="wrap">
            <Button variant="secondary" mr={3} mb={3}>
              Secondary
            </Button>
            <Button
              variant="secondary"
              mr={3}
              mb={3}
              leftIcon={<Icons.Place aria-hidden />}
            >
              Left Icon
            </Button>
            <Button variant="secondary" mb={3} isLoading>
              Loading
            </Button>
          </Flex>
        </Box>
        <Box mb={4} bg="bg.secondary" p={4}>
          <FormExample />
          <FormControl.FieldSet>
            <Label htmlFor="city" required>
              City
            </Label>
            <Select id="city" defaultValue="Select a city" rightIcon={<Icons.Info color="text.primary" aria-hidden />}>
              <option>Select a city</option>
              <option>Toronto</option>
              <option>Istanbul</option>
              <option>Amsterdam</option>
            </Select>
          </FormControl.FieldSet>
        </Box>
        <Box bg="bg.secondary" p={4} mb={4}>
          <FormControl.FieldSet>
            <Label htmlFor="terms" required>
              Terms and Conditions
            </Label>
            <Checkbox id="terms" aria-describedby="error-text" label="I agree to the terms and conditions." error />
            <FormControl.Error id="error-text">
              Please agree to the terms and conditions
            </FormControl.Error>
          </FormControl.FieldSet>
        </Box>
      </Box>
      <Box flex="none" width={['100%', '100%', '50%']}>
        <Box bg="bg.secondary" mb={4} p={4}>
          <FormControl.Field mb={4}>
            <Label htmlFor="zip-code" required>
              Zip Code
            </Label>
            <Input
              aria-describedby="helper-text"
              id="zip-code"
              placeholder="Zip Code"
              value="20905"
              rightIcon={<Icons.CheckCircle aria-hidden color="ui.success" />}
            />
            <FormControl.Hint id="helper-text">5 Digits</FormControl.Hint>
          </FormControl.Field>
          <FormControl.Field>
            <Label htmlFor="zip-code-2" required>
              Zip Code
            </Label>
            <Input
              id="zip-code-2"
              placeholder="Zip Code"
              aria-describedby="helper-text-2 error-text-2"
              error
              rightIcon={<Icons.Error aria-hidden color="ui.error" />}
            />
            <FormControl.Hint id="helper-text-2">5 Digits</FormControl.Hint>
            <FormControl.Error id="error-text-2">
              Please enter a ZIP code
            </FormControl.Error>
          </FormControl.Field>
        </Box>
        <Box bg="bg.secondary" mb={4} p={4}>
          <FormControl.Field mb={4}>
            <Label htmlFor="review" required>
              Feedback
            </Label>
            <TextArea id="feedback" value="" placeholder="Tell us your thoughts" maxCharacters={100} />
          </FormControl.Field>
          <FormControl.Field>
            <Label htmlFor="feedback-3" required>
              Feedback
            </Label>
            <TextArea id="feedback-3" value="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque non accumsan lacus. Nullam ornare ipsum eget nisi gravida aliquet. Suspendisse vehicula tortor et nunc ullamcorper, ut molestie ipsum semper." aria-describedby="error-text" placeholder="Tell us your thoughts" maxCharacters={100} error />
            <FormControl.Error id="error-text">
              Please enter a maximum of 100 characters.
            </FormControl.Error>
          </FormControl.Field>
        </Box>
      </Box>
    </Flex>
  </Box>
</ThemeProvider>